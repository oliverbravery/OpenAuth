from fastapi.param_functions import Form
from enum import Enum
        
class AuthorizationForm:
    """
    A class used to represent the data required to authorize a user following the OAuth2.0 protocol.
    It is used to parse the data from the request body when authorizing a user.
    """
    def __init__(
        self,
        username: str = Form(),
        password: str = Form(),
        client_id: str = Form(),
        client_secret: str = Form(), 
        scope: list[str] = Form(), 
        response_type: str = Form(),
        state: str = Form(),
        code_challenge: str = Form(),
    ):
        """
        The constructor for the AuthorizationForm class.
        
        Args:
            username (str): The username of the user.
            password (str): The plaintext password of the user.
            client_id (str): The id of the application. Used to know which application is requesting access.
            client_secret (str, optional): Optional. The secret of the application. Used to authenticate the application.
            scope (list[str]): The list of requested scopes.
            response_type (str): The type of response. Should be 'code' for the authorization code flow.
            state (str): A random string generated by the client. Used to prevent CSRF attacks. Returned in the response.
            code_challenge (str): The code challenge generated by the client. Used by PKCE to prevent code interception attacks.
        """
        self.username: str = username
        self.password: str = password
        self.client_id: str = client_id
        self.client_secret: str = client_secret
        self.scope: list[str] = scope
        self.response_type: str = response_type
        self.state: str = state
        self.code_challenge: str = code_challenge